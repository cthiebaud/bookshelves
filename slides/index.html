<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Demo</title>
    <style>
        .task-result {
            display: none; /* Hide task results by default */
        }
    </style>
</head>
<body>

<div id="output">
    <!-- Each task result is associated with a specific element -->
    <div class="task-result" id="result1"></div>
    <div class="task-result" id="result2"></div>
    <div class="task-result" id="result3"></div>
    <div class="task-result" id="result4"></div>
    <div class="task-result" id="result5"></div>
</div>
<button id="startButton" onclick="startTasks()">Start Tasks</button>

<script>
// Simulate a task that takes some time (represents a server request)
function simulateTask(taskNumber) {
    return new Promise(resolve => {
        setTimeout(() => {
            resolve(`Task ${taskNumber} completed`);
        }, Math.random() * 2000 + 1000);
    });
}

// Execute tasks sequentially
async function executeSequentialTasks() {
    for (let i = 1; i <= 5; i++) {
        const result = await simulateTask(i);
        displayResult(result, i);
    }
}

// Display the result or status on the page
function displayResult(result, taskNumber) {
    const resultDiv = document.getElementById(`result${taskNumber}`);
    resultDiv.innerHTML = `<p>${result}</p>`;
    resultDiv.style.display = 'block'; // Show the result div
}

// Start tasks based on the selected mode
function startTasks() {
    const urlParams = new URLSearchParams(window.location.search);
    const mode = urlParams.get('mode') || 'normal'; // Get mode from query string or default to 'normal'

    executeSequentialTasks();
    if (mode === 'normal') {
        document.getElementById('output').style.display = 'block'; // Show results immediately
    } else if (mode === 'slideshow') {
        document.getElementById('startButton').style.display = 'none';
        let currentTask = 1;

        function showNextTask() {
            const resultDiv = document.getElementById(`result${currentTask}`);
            if (resultDiv) {
                if (resultDiv.innerHTML === '') {
                    resultDiv.innerHTML = `<p>Task ${currentTask} is in progress...</p>`;
                } else {
                    currentTask++;
                    if (currentTask <= 5) {
                        document.addEventListener('keydown', handleUserInteraction);
                    }
                }
            }
        }

        function handleUserInteraction(event) {
            if (event.key === 'Enter') {
                showNextTask();
            }
        }

        document.addEventListener('keydown', handleUserInteraction);
    } else {
        alert('Invalid mode. Please enter "normal" or "slideshow".');
    }
}
</script>

</body>
</html>
