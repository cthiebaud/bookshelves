<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    /* Add your styles here */
    .scatter-point {
      fill: steelblue;
    }
    .plane-line {
      stroke: red;
    }
    .line-within-plane {
      stroke: green;
    }
  </style>
</head>
<body>
  <script>
    // Assuming you have the 3D data points in the variable 'data'
    // Replace this with your actual data
    var data = [
      { x: 1, y: 2, z: 3 },
      { x: 2, y: 3, z: 4 },
      // Add more data points as needed
    ];

    // Replace with your actual coefficients and mse values
    var planeCoefficients = [[ 1.00000000e+00, -4.64254679e-17, -5.08617110e-17], [-3.45107426e-15,  1.00000000e+00,  0.00000000e+00], [-1.64309155e-15,  3.21964677e-15,  1.00000000e+00]];
    var lineCoefficients = [[ 1.00000000e+00,  2.84109350e-15], [ 2.40079403e-14,  1.00000000e+00], [-1.67586356e-01,  1.24927914e+00]];
    var msePlane = 3.3738183975116346e-33; // Replace with your actual value
    var mseLineWithinPlane = 3.544543230436131e-06; // Replace with your actual value

    var width = 500;
    var height = 500;

    var svg = d3.select('body')
      .append('svg')
      .attr('width', width)
      .attr('height', height);

    // Create circles for each data point
    svg.selectAll('.scatter-point')
      .data(data)
      .enter().append('circle')
      .attr('class', 'scatter-point')
      .attr('cx', d => d.x)
      .attr('cy', d => d.y)
      .attr('r', 5)
      .attr('opacity', 0.7);

    // Create a line representing the plane
    var planeLine = d3.line()
      .x(d => d.x)
      .y(d => d.y)
      .curve(d3.curveLinear);

    // Generate points on the plane (adjust the range based on your data)
    var planePoints = [];
    for (var i = 0; i <= width; i += 10) {
      for (var j = 0; j <= height; j += 10) {
        var x = i;
        var y = j;
        var z = -(planeCoefficients[0] * x + planeCoefficients[1] * y) / planeCoefficients[2];
        planePoints.push({ x, y, z });
      }
    }

    // Draw the plane
    svg.append('path')
      .data([planePoints])
      .attr('class', 'plane-line')
      .attr('d', planeLine)
      .attr('stroke-width', 2)
      .attr('fill', 'none');

    // Create a line representing the line within the plane
    var lineWithinPlane = d3.line()
      .x(d => d.x)
      .y(d => d.y)
      .curve(d3.curveLinear);

    // Generate points on the line within the plane (adjust the range based on your data)
    var linePointsWithinPlane = [];
    for (var i = 0; i <= width; i += 10) {
      var x = i;
      var y = -(lineCoefficients[0] * x) / lineCoefficients[1];
      var z = -(planeCoefficients[0] * x + planeCoefficients[1] * y) / planeCoefficients[2];
      linePointsWithinPlane.push({ x, y, z });
    }

    // Draw the line within the plane
    svg.append('path')
      .data([linePointsWithinPlane])
      .attr('class', 'line-within-plane')
      .attr('d', lineWithinPlane)
      .attr('stroke-width', 2)
      .attr('fill', 'none');
  </script>
</body>
</html>
